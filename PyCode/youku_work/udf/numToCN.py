#!/usr/bin/python
# -*- encoding: utf-8 -*-
import re,types,json
import sys
reload(sys)
sys.setdefaultencoding('utf-8')

patStr=u'(第)([一二三四五六七八九十百千]*)([季集部期])'
pat = re.compile(patStr)

log="""
宋小宝小品集锦:2,1,0,0,0,100000.000000,2,7,1272385,298318,193367,70771,75957,84200,19600,12722,4482,4801,68356,16166,10410,3581,3824,35026035,7886633,4684775,1514730,1693035,41232,9020,5609,1899,1995,17813,4931,3466,1211,1309,0.00035,1.0,0.06179,0.00134,0.00001,0.0002,0,0.01279,0.06659,0.02372,0.00255,0.01992,0.00015,0.00304,0.04526,0.00605,0,0.00002,0.00222,0,0,0.00001,0.00016,0.00585,0宋小宝:5,1,0,0,0,79411.000000,5,3,13110648,1993513,1097289,433127,414016,716003,102805,53286,20491,20529,544619,80742,42599,16132,16158,262133176,34380542,17298442,6528744,6876726,280895,38272,19959,7371,7388,166431,29601,15780,6067,6027,0.0,1.0,0.01677,0.00669,0.00013,0.00001,0.00061,0.00117,0.16879,0.08515,0.09278,0.21626,0.0062,0.00255,0.02178,0.02318,0.00018,0.0,0.00046,0.00916,0.0,0.00001,0.00001,0.0685,0宋小宝小品最新:2,1,0,0,0,61764.000000,2,7,890307,130540,92611,33949,35847,54651,7076,4692,1623,1786,43907,5937,3845,1314,1424,22590441,2728520,1496426,500472,618009,27199,3341,2169,717,798,10335,1801,1176,441,420,0,1.0,0.02952,0.00625,0.00006,0,0,0.00227,0.03419,0.00004,0.00199,0.01333,0.0001,0.00006,0.01384,0.03875,0,0,0.00015,0,0,0.00005,0.00001,0.00262,0宋小宝电视剧:2,1,0,0,0,47058.000000,2,6,707362,78764,40978,11272,9953,42941,4553,2264,719,585,24879,2874,1369,405,341,14390857,1590060,771554,220848,169229,12624,1462,670,180,154,8736,1041,500,173,143,0.00022,0.49108,0.03059,0.00033,0.0078,0,0,0.00041,0.06236,0.00177,0.05308,1.0,0.02288,0.00003,0.00016,0.01415,0,0,0.00071,0.15014,0,0.00125,0,0.00369,0宋小宝甄嬛后传:2,1,0,0,0,11764.000000,2,7,41715,7792,6122,3041,2204,5890,1266,921,449,347,4859,1027,785,360,252,2023815,422897,287760,121231,87841,2468,509,335,142,103,1114,256,228,110,72,0,1.0,0.01736,0.00486,0,0,0,0,0.04341,0,0.00067,0.01115,0,0,0,0.04503,0,0,0.00043,0,0,0.00032,0,0.00024,0宋小宝咖妃:2,1,0,0,0,5882.000000,2,5,95759,8079,7509,3326,2533,12070,986,732,370,240,10339,879,653,323,219,3650510,277354,162829,64756,58393,5330,453,321,133,113,3071,287,249,138,70,0,1.0,0.012,0.00038,0,0,0.00055,0,0.05196,0,0,0.00563,0,0,0.0008,0.00138,0,0,0,0,0,0,0,0.00012,0宋小宝小品:2,1,0,0,0,2941.000000,2,5,1822935,385803,303844,117088,105395,125199,25691,18928,7334,6313,95465,20729,15028,5759,4938,50143872,9603987,6724972,2471622,2165266,57801,11648,8182,3019,2646,22736,6044,4642,1882,1635,0,1.0,0.00428,0.01177,0.00107,0.00008,0.00194,0.00135,0.03027,0.02072,0.00026,0.03271,0.00109,0.0016,0.03601,0.02751,0.00034,0,0.00007,0.0001,0.0,0.00001,0.0004,0.002,0宋小宝碰瓷:2,1,0,0,0,2941.000000,2,5,72890,9653,3764,1210,1406,9829,1387,361,93,121,8011,1162,291,68,101,3459364,494179,74067,21908,37115,4657,660,119,33,48,1386,245,127,26,29,0,1.0,0.02419,0.01263,0,0,0,0.00033,0.09249,0.00587,0,0.01215,0,0,0,0.06372,0,0,0.00136,0,0,0,0,0,0宋小宝2018跨年晚会:3,1,0,0,0,0.000000,3,11,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0宋小宝小沈阳小品:2,1,0,0,0,0.000000,2,8,167597,24429,16461,6127,6508,9539,1395,890,339,357,7639,1162,727,296,271,3620975,500776,287576,97489,90017,4646,662,398,147,134,1896,345,231,107,105,0,1.0,0.01422,0.00403,0,0.00009,0,0.00042,0.04752,0,0.00057,0.00661,0,0,0.01883,0.02516,0,0,0,0,0,0,0,0,0
"""

dict_trans = {
    u'一':1,
    u'二':2,
    u'三':3,
    u'四':4,
    u'五':5,
    u'六':6,
    u'七':7,
    u'八':8,
    u'九':9,
}


def evaluate(targetStr):
    if targetStr is None:
        return None
    line = unicode(targetStr, 'utf8')
    for match in re.finditer(pat, line):
        targetStr = match.group(0)
        str1 = match.group(1)
        str2 = match.group(2)
        str3 = match.group(3)
        targetNum = 0
        totalNum = 0
        for uni in str2:
            if u'十' == uni:
                if targetNum == 0:
                    targetNum += 10
                else:
                    targetNum *= 10
                totalNum += targetNum
                targetNum = 0
            elif u'百' == uni:
                totalNum += targetNum * 100
                targetNum = 0
            elif u'千' == uni:
                totalNum += targetNum * 1000
                targetNum = 0
            else:
                targetNum += dict_trans[uni]
        totalNum += targetNum

        tranStr = '%s%d%s' % (str1, totalNum, str3)
        line = line.replace(targetStr, tranStr)
    if not line:
        return ''
    if type(line) != types.UnicodeType:
        line = line.decode('utf8')
        # text = text.decode('utf8')
    return ''.join([i for i in line if not ord(i) == 32]).encode('utf8')

def evaluate2(log, fieldName):
    log = log.decode('utf8')
    field = log.split('CustomLog :')
    data = field[1]
    field = data.split('\t')
    # return len(field)
    if fieldName == "aaid":
        return field[0]

    if fieldName == "items":
        if len(field) >= 2:
            return field[1].encode('utf8')
        else:
            return "NULL".encode('utf8')

def evaluate3(title_w, idx):
    if title_w is None or title_w == "":
        return ''
    arr = title_w.split(':')
    list = []
    list.append(arr[-1])
    list.append(':'.join(arr[:len(arr) - 1]))
    return list[idx]


if __name__ == '__main__':
    print evaluate3('丧尸围城1:2,1,0,0,0,100000.000000,2,5,54810,11111,4043,1971,1654,1346,355,144,79,75,977,277,93,50,35,465612,115105,24515,17328,15614,355,71,26,15,12,433,162,55,26,18,0,0,0.00831,0.02048,0,0,0.00159,0.02698,0,0,0.22236,0.04836,0,1.0,0.02698,0.00428,0,0.00307,0,0,0,0,0,0.02791,0', 0)
    #print evaluate2(log, 'items')
    #print evaluate('第三部')
    #print len("微微一笑a".decode('utf-8'))
    # with open('/Users/tanzhen/Desktop/json0131.txt', 'r') as f:
    #     for line in f:
    #         #line = line.decode('utf8').lower()
    #         line = str(line.decode('utf8'))
    #         field = str(line).split('\t')
    #         js = str(field[8])
    #         jsObj = json.loads(js)
    #         print(jsObj['company_name'])
    #
    #         #print(js)